<!DOCTYPE html>
<html lang="fr" data-theme="dark">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Chatbot IA â€” Nicolas Tuor</title>
  <link rel="icon" href="/favicon.ico">
  <link rel="stylesheet" href="/style.css">
  <style>
    .chat { max-width: 820px; margin: 0 auto; }
    .chat-box { background: var(--panel); border:1px solid color-mix(in oklab,var(--ink),transparent 85%); border-radius:16px; padding:14px; box-shadow:var(--shadow); min-height:260px; }
    .msg { background: var(--bg-soft); border:1px solid color-mix(in oklab,var(--ink),transparent 85%); padding:10px 12px; border-radius:12px; margin:10px 0; }
    .me { border-color: color-mix(in oklab, var(--brand), transparent 70%); }
    .row { display:flex; gap:10px; margin-top:10px; }
    .row input { flex:1; padding:10px; border-radius:10px; border:1px solid color-mix(in oklab,var(--ink),transparent 80%); background: var(--bg-soft); color: var(--ink); }
  </style>
</head>
<body>
<header class="site-header">
  <nav class="wrap row" aria-label="Navigation principale" style="padding:10px 16px">
    <a href="/" class="btn ghost">Accueil</a>
    <a href="/portfolio.html" class="btn ghost">Portfolio</a>
    <a href="/cv.html" class="btn ghost">CV</a>
    <a href="/chatbot.html" class="btn" aria-current="page">Chatbot</a>
    <a href="/ai-lab.html" class="btn ghost">IdÃ©es IA</a>
    <a href="/fun-facts.html" class="btn ghost">Fun Facts</a>
    <span style="flex:1"></span>
    <a href="/chatbot.html" class="btn">FR</a>
    <a href="/chatbot-en.html" class="btn ghost">EN</a>
    <a href="/chatbot-de.html" class="btn ghost">DE</a>
  </nav>
</header>

<main class="section container chat">
  <h1 class="title">ðŸ¤– Chatbot IA</h1>
  <p class="lead">Posez vos questions â€” pÃ©dagogie, IA, expÃ©rience. Le bot peut aussi se rÃ©fÃ©rer Ã  mon CV si vous en parlez.</p>

  <div id="chat" class="chat-box" aria-live="polite"></div>

  <div class="row">
    <input id="q" type="text"
           placeholder="Exemple : Â« Est-ce que le candidat a des compÃ©tences en programmation ? Est-ce qu'il a des connaissances en enseignement Â»" />
    <button id="send" class="btn primary">Envoyer</button>
  </div>
</main>

<script>
  const chat = document.getElementById('chat');
  function add(text, me=false){
    const p = document.createElement('div');
    p.className = 'msg' + (me ? ' me' : '');
    p.textContent = text;
    chat.appendChild(p);
    chat.scrollTop = chat.scrollHeight;
  }

  // message dâ€™accueil
  add("Bonjour ! Posez une question sur le candidat.");

  async function ask(){
    const q = document.getElementById('q');
    const text = (q.value || "").trim();
    if (!text) return;
    add(text, true);
    q.value = "";
    add("â€¦");
    try {
      const r = await fetch('/api/chat', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        // Indice discret pour lâ€™API (ne casse rien si ignorÃ©) :
        body: JSON.stringify({
          question: text,
          lang: 'fr',
          cv_url: '/CV_Nicolas_Tuor.pdf'    // <â€” hint pour que le backend aille le lire si prÃ©vu
        })
      });
      const j = await r.json().catch(()=>({}));
      chat.lastChild.textContent = j && j.answer ? j.answer : "Dâ€™accord. Pouvez-vous prÃ©ciser votre question ?";
    } catch (e) {
      chat.lastChild.textContent = "Oups â€” impossible de rÃ©pondre pour lâ€™instant.";
    }
  }

  document.getElementById('send').addEventListener('click', ask);
  document.getElementById('q').addEventListener('keydown', e => { if (e.key === 'Enter') ask(); });
</script>
</body>
</html>
