<!DOCTYPE html>
<html lang="fr" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Id√©es IA en √©ducation ‚Äî Nicolas Tuor</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
<header class="nav">
  <div class="container">
    <a class="brand" href="./index.html"><span class="brand-badge">NT</span><span class="brand-text">Nicolas Tuor</span></a>
    <nav class="nav-links">
      <a href="./cv.html">CV</a>
      <a href="./portfolio.html">Portfolio</a>
      <a class="is-active" href="./ai-lab.html">Id√©es IA en √©ducation</a>
      <a href="./chatbot.html">Chatbot</a>
      <button id="dlCvBtn" class="btn linkish">T√©l√©charger le PDF</button>
    </nav>
    <div class="nav-links">
      <button class="btn linkish" data-toggle-theme>üåì</button>
      <a class="btn linkish" href="./ai-lab.html">FR</a>
      <a class="btn linkish" href="./portfolio-en.html">EN</a>
      <a class="btn linkish" href="./portfolio-de.html">DE</a>
    </div>
  </div>
</header>

<main class="container section">
  <h1>Id√©es IA en √©ducation</h1>
  <p class="lead">D√©cris ton contexte ; l‚ÄôIA propose des √©tapes, tu argumentes (texte/URL) et elle r√©pond avec un feedback didactique.</p>

  <form id="labGen" class="stack">
    <label>√Çge / niveau
      <input id="labAge" type="text" placeholder="ex. 10‚Äì11 ans, 6H" />
    </label>
    <label>Th√®me
      <input id="labTopic" type="text" placeholder="ex. fractions, cycle de l‚Äôeau‚Ä¶" />
    </label>
    <button class="btn" data-busy>G√©n√©rer des √©tapes</button>
  </form>

  <div id="steps" class="stack"></div>

  <section id="arg" class="stack" hidden>
    <h2>Mes arguments / preuves</h2>
    <label>Notes (libre)
      <textarea id="labNotes" rows="4" placeholder="Que ferais-tu ? Pourquoi ?"></textarea>
    </label>
    <label>Sources / URLs (optionnel)
      <textarea id="labUrls" rows="2" placeholder="Une URL par ligne"></textarea>
    </label>
    <button id="judgeBtn" class="btn" data-busy>Demander un feedback</button>
    <pre id="judgeOut" class="code"></pre>
  </section>
</main>

<script src="./site.js" defer></script>
<script>
const $ = s => document.querySelector(s);
const stepsBox = $('#steps');
const arg = $('#arg');
$('#labGen').addEventListener('submit', async e => {
  e.preventDefault();
  const btn = e.target.querySelector('[data-busy]');
  window.UI.setBusy(btn, true);
  stepsBox.innerHTML = "";
  arg.hidden = true;

  const age = $('#labAge').value.trim();
  const topic = $('#labTopic').value.trim();

  try{
    const r = await fetch('/api/factcheck', {
      method:'POST', headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ mode:'generate', lang:'fr', topic, age })
    });
    const data = await r.json();
    if(Array.isArray(data.steps)){
      stepsBox.innerHTML = data.steps.map((s,i)=>`<div class="card3d">
        <div class="face front"><span>${i+1}</span></div>
        <div class="face back"><p>${s}</p></div>
      </div>`).join('');
      arg.hidden = false;
    }
  } finally { window.UI.setBusy(btn,false); }
});

document.addEventListener('click', e=>{
  const c = e.target.closest('.card3d'); if(c) c.classList.toggle('is-flipped');
});

$('#judgeBtn').addEventListener('click', async ()=>{
  const btn = $('#judgeBtn'); window.UI.setBusy(btn,true);
  try{
    const age = $('#labAge').value.trim();
    const topic = $('#labTopic').value.trim();
    const notes = $('#labNotes').value.trim();
    const urls = $('#labUrls').value.trim().split(/\n+/).filter(Boolean);
    const r = await fetch('/api/factcheck', {
      method:'POST', headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ mode:'judge', lang:'fr', topic, age, notes, urls })
    });
    const data = await r.json();
    $('#judgeOut').textContent = data.feedback || JSON.stringify(data,null,2);
  } finally { window.UI.setBusy(btn,false); }
});
</script>
</body>
</html>
